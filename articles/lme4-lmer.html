<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>lme4::lmer Models • equatiomatic</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="lme4::lmer Models">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">equatiomatic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/equatiomatic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/colors.html">Colorizing equations and swapping variable names</a>
    </li>
    <li>
      <a href="../articles/forecast-arima.html">forecast::Arima Models</a>
    </li>
    <li>
      <a href="../articles/lme4-lmer.html">lme4::lmer Models</a>
    </li>
    <li>
      <a href="../articles/plotting-integration.html">Plotting with {equatiomatic}</a>
    </li>
    <li>
      <a href="../articles/tests_and_coverage.html">Tests and Coverage</a>
    </li>
    <li>
      <a href="../articles/usage-shiny.html">Usage with shiny</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/datalorax/equatiomatic/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>lme4::lmer Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/datalorax/equatiomatic/blob/master/vignettes/lme4-lmer.Rmd" class="external-link"><code>vignettes/lme4-lmer.Rmd</code></a></small>
      <div class="hidden name"><code>lme4-lmer.Rmd</code></div>

    </div>

    
    
<p>This vignette is intended to show the wide variety of
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer</a></code> models that can be handled by {equatiomatic}.
The output uses the notation from <a href="https://sites.stat.columbia.edu/gelman/arm/" class="external-link">Gelman and Hill</a>.
If you notice any errors in the notation, please <a href="https://github.com/datalorax/equatiomatic/issues" class="external-link">file an
issue</a>. Similarly, if you try to use {equatiomatic} with an lmer
model and end up with an error (either in notation or code) I would
<em>really</em> appreciate if you could file an issue with a
reproducible example.</p>
<p>This vignette displays many of the models that are covered by the
package tests. It also illustrates many of the features of
{equatiomatic}, including</p>
<ul>
<li>Automatic detection of group-level predictor variables (and the
level at which they predict)</li>
<li>Handling of interactions, both within a level and across levels</li>
<li>Handling of any number of higher-level (or cross-classified)
grouping factors (i.e., number of levels or random effects is
infinite)</li>
<li>Some support for variance-covariance structure outside of standard
unstructured specifications</li>
</ul>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datalorax/equatiomatic" class="external-link">equatiomatic</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'equatiomatic'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:datasets':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     penguins</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unconditional-models">Unconditional models<a class="anchor" aria-label="anchor" href="#unconditional-models"></a>
</h3>
<p>A basic two-level unconditional model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">um_hsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hsb</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">um_hsb</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\alpha_{j[i]}, \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>And a model with multiple levels:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">um_long3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">um_long3</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>k</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>l</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]}, \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sid j = 1,} \dots \text{,J} \\
    \alpha_{k}  &amp;\sim N \left(\mu_{\alpha_{k}}, \sigma^2_{\alpha_{k}} \right)
    \text{, for school k = 1,} \dots \text{,K} \\
    \alpha_{l}  &amp;\sim N \left(\mu_{\alpha_{l}}, \sigma^2_{\alpha_{l}} \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="models-with-predictors-at-level-1">Models with predictors at level 1<a class="anchor" aria-label="anchor" href="#models-with-predictors-at-level-1"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lev1_hsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">minority</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>, <span class="va">hsb</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">lev1_hsb</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1}(\operatorname{female}) + \beta_{2}(\operatorname{ses}) + \beta_{3}(\operatorname{minority}) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>Note that in the above, the mean structure at level 1 is broken out
into a separate line. You can override this with the
<code>mean_separate</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">lev1_hsb</span>, mean_separate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\alpha_{j[i]} + \beta_{1}(\operatorname{female}) + \beta_{2}(\operatorname{ses}) + \beta_{3}(\operatorname{minority}), \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>Similarly, just like with standard <code>lm</code> models, you can
specify wrapping, and how many terms per line</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">lev1_hsb</span>, wrap <span class="op">=</span> <span class="cn">TRUE</span>, terms_per_line <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mo>+</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1}(\operatorname{female})\ + \\
&amp;\quad \beta_{2}(\operatorname{ses}) + \beta_{3}(\operatorname{minority}) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>And one more example with multiple levels</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lev1_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">lev1_long</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>k</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>l</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]} + \beta_{1}(\operatorname{wave}), \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sid j = 1,} \dots \text{,J} \\
    \alpha_{k}  &amp;\sim N \left(\mu_{\alpha_{k}}, \sigma^2_{\alpha_{k}} \right)
    \text{, for school k = 1,} \dots \text{,K} \\
    \alpha_{l}  &amp;\sim N \left(\mu_{\alpha_{l}}, \sigma^2_{\alpha_{l}} \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="models-with-unstructured-variance-covariance-specifications">Models with unstructured variance-covariance specifications<a class="anchor" aria-label="anchor" href="#models-with-unstructured-variance-covariance-specifications"></a>
</h3>
<p>This should generally work regardless of the complexity.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">minority</span> <span class="op">+</span> <span class="op">(</span><span class="va">minority</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">hsb1</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1}(\operatorname{female}) + \beta_{2}(\operatorname{ses}) + \beta_{3j[i]}(\operatorname{minority}) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{3j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{3j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{3j}} \\ 
     \rho_{\beta_{3j}\alpha_{j}} &amp; \sigma^2_{\beta_{3j}}
  \end{array}
\right)
 \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>Notice that it correctly parses which variable is randomly varying
here. We can also make it more complicated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">minority</span> <span class="op">+</span> <span class="op">(</span><span class="va">female</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">hsb2</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1j[i]}(\operatorname{female}) + \beta_{2j[i]}(\operatorname{ses}) + \beta_{3}(\operatorname{minority}) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j} \\
      &amp;\beta_{2j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{1j}} \\
      &amp;\mu_{\beta_{2j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{ccc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} &amp; \rho_{\alpha_{j}\beta_{2j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}} &amp; \rho_{\beta_{1j}\beta_{2j}} \\ 
     \rho_{\beta_{2j}\alpha_{j}} &amp; \rho_{\beta_{2j}\beta_{1j}} &amp; \sigma^2_{\beta_{2j}}
  \end{array}
\right)
 \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>And even really complicated. Note the model below gives a
warning.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsb3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">*</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">minority</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="va">ses</span> <span class="op">*</span> <span class="va">female</span> <span class="op">+</span> <span class="va">minority</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">hsb3</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo>×</mo><mo>ses</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>4</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1j[i]}(\operatorname{female}) + \beta_{2j[i]}(\operatorname{ses}) + \beta_{3j[i]}(\operatorname{minority}) + \beta_{4j[i]}(\operatorname{female} \times \operatorname{ses}) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j} \\
      &amp;\beta_{2j} \\
      &amp;\beta_{3j} \\
      &amp;\beta_{4j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{1j}} \\
      &amp;\mu_{\beta_{2j}} \\
      &amp;\mu_{\beta_{3j}} \\
      &amp;\mu_{\beta_{4j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{ccccc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} &amp; \rho_{\alpha_{j}\beta_{2j}} &amp; \rho_{\alpha_{j}\beta_{3j}} &amp; \rho_{\alpha_{j}\beta_{4j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}} &amp; \rho_{\beta_{1j}\beta_{2j}} &amp; \rho_{\beta_{1j}\beta_{3j}} &amp; \rho_{\beta_{1j}\beta_{4j}} \\ 
     \rho_{\beta_{2j}\alpha_{j}} &amp; \rho_{\beta_{2j}\beta_{1j}} &amp; \sigma^2_{\beta_{2j}} &amp; \rho_{\beta_{2j}\beta_{3j}} &amp; \rho_{\beta_{2j}\beta_{4j}} \\ 
     \rho_{\beta_{3j}\alpha_{j}} &amp; \rho_{\beta_{3j}\beta_{1j}} &amp; \rho_{\beta_{3j}\beta_{2j}} &amp; \sigma^2_{\beta_{3j}} &amp; \rho_{\beta_{3j}\beta_{4j}} \\ 
     \rho_{\beta_{4j}\alpha_{j}} &amp; \rho_{\beta_{4j}\beta_{1j}} &amp; \rho_{\beta_{4j}\beta_{2j}} &amp; \rho_{\beta_{4j}\beta_{3j}} &amp; \sigma^2_{\beta_{4j}}
  \end{array}
\right)
 \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="group-level-predictors">Group level predictors<a class="anchor" aria-label="anchor" href="#group-level-predictors"></a>
</h2>
<p>In the <code>sim_longitudinal</code> data that comes with the
package, the only level 1 predictor is <code>wave</code>. The
<code>group</code> and <code>treatement</code> variables are at the
student level (level 2) and <code>prop_low</code> is at the school
level. Let’s also add a district level variable (just the average score
for each district).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate district means</span></span>
<span><span class="va">dist_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_longitudinal</span><span class="op">$</span><span class="va">score</span>,</span>
<span>  <span class="va">sim_longitudinal</span><span class="op">$</span><span class="va">district</span>,</span>
<span>  <span class="va">mean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># put them in a df to merge</span></span>
<span><span class="va">dist_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  district <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist_mean</span><span class="op">)</span>,</span>
<span>  dist_mean <span class="op">=</span> <span class="va">dist_mean</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new df with dist_mean added</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sim_longitudinal</span>, <span class="va">dist_mean</span>, by <span class="op">=</span> <span class="st">"district"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can fit a model that should have predictors at every level.
We’ll allow <code>wave</code> to vary randomly at each level too.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_preds_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">+</span> <span class="va">group</span> <span class="op">+</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">prop_low</span> <span class="op">+</span> <span class="va">dist_mean</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>data <span class="op">=</span> <span class="va">d</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">group_preds_m1</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>3</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><msub><mi>α</mi><mi>k</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>l</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>dist_mean</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>l</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><msub><mi>α</mi><mi>l</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]} + \beta_{1j[i],k[i],l[i]}(\operatorname{wave}), \sigma^2 \right) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{group}_{\operatorname{low}}) + \gamma_{2}^{\alpha}(\operatorname{group}_{\operatorname{medium}}) + \gamma_{3}^{\alpha}(\operatorname{treatment}_{\operatorname{1}}) \\
      &amp;\mu_{\beta_{1j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}}
  \end{array}
\right)
 \right)
    \text{, for sid j = 1,} \dots \text{,J} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{k} \\
      &amp;\beta_{1k}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{prop\_low}) \\
      &amp;\mu_{\beta_{1k}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{k}} &amp; \rho_{\alpha_{k}\beta_{1k}} \\ 
     \rho_{\beta_{1k}\alpha_{k}} &amp; \sigma^2_{\beta_{1k}}
  \end{array}
\right)
 \right)
    \text{, for school k = 1,} \dots \text{,K} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{l} \\
      &amp;\beta_{1l}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{dist\_mean}) \\
      &amp;\mu_{\beta_{1l}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{l}} &amp; \rho_{\alpha_{l}\beta_{1l}} \\ 
     \rho_{\beta_{1l}\alpha_{l}} &amp; \sigma^2_{\beta_{1l}}
  \end{array}
\right)
 \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
<div class="section level3">
<h3 id="interactions">Interactions<a class="anchor" aria-label="anchor" href="#interactions"></a>
</h3>
<p>Interactions with multilevel models can be tricky because they can be
within or across levels, and the notation changes depending on whether
the random effect for the lower level (in the interaction term) is
specified as varying randomly within the given level. Luckily,
{equatiomatic} handles all of this for you.</p>
<p>First, let’s look at a model with interactions only at level 1.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l1_hsb_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">minority</span> <span class="op">*</span> <span class="va">female</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">l1_hsb_int</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo>×</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1}(\operatorname{minority}) + \beta_{2}(\operatorname{female}) + \beta_{3}(\operatorname{female} \times \operatorname{minority}) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>And now an interaction at only level 2</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l2_hsb_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">meanses</span> <span class="op">*</span> <span class="va">sector</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">l2_hsb_int</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>meanses</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>sector</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>3</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>meanses</mo><mo>×</mo><mo>sector</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\alpha_{j[i]}, \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{meanses}) + \gamma_{2}^{\alpha}(\operatorname{sector}) + \gamma_{3}^{\alpha}(\operatorname{meanses} \times \operatorname{sector}), \sigma^2_{\alpha_{j}} \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>But more complicated are cross level interactions. Here’s a quick
example.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_long1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>data <span class="op">=</span> <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span><span class="co">#&gt; Model failed to converge with max|grad| = 0.00277081 (tol = 0.002, component 1)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">cl_long1</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>k</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>l</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]} + \beta_{1j[i]}(\operatorname{wave}), \sigma^2 \right) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{treatment}_{\operatorname{1}}) \\
      &amp;\gamma^{\beta_{1}}_{0} + \gamma^{\beta_{1}}_{1}(\operatorname{treatment}_{\operatorname{1}})
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}}
  \end{array}
\right)
 \right)
    \text{, for sid j = 1,} \dots \text{,J} \\    \alpha_{k}  &amp;\sim N \left(\mu_{\alpha_{k}}, \sigma^2_{\alpha_{k}} \right)
    \text{, for school k = 1,} \dots \text{,K} \\    \alpha_{l}  &amp;\sim N \left(\mu_{\alpha_{l}}, \sigma^2_{\alpha_{l}} \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
<p>Note that the <code>treatement</code> variable is shown as a
predictor of the level 1 intercept and the level 1 slope. But if the
slope is not randomly varying at this level, then the notation has to
change.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_long2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>data <span class="op">=</span> <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">cl_long2</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>j</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo>×</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>k</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>l</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]} + \beta_{1}(\operatorname{wave}), \sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{treatment}_{\operatorname{1}}) + \gamma_{2}^{\alpha}(\operatorname{treatment}_{\operatorname{1}} \times \operatorname{wave}), \sigma^2_{\alpha_{j}} \right)
    \text{, for sid j = 1,} \dots \text{,J} \\
    \alpha_{k}  &amp;\sim N \left(\mu_{\alpha_{k}}, \sigma^2_{\alpha_{k}} \right)
    \text{, for school k = 1,} \dots \text{,K} \\
    \alpha_{l}  &amp;\sim N \left(\mu_{\alpha_{l}}, \sigma^2_{\alpha_{l}} \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
<p>This works even for really complicated models, including three-way
interactions that contain a cross-level interaction. For example</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_long3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">*</span> <span class="va">group</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">wave</span> <span class="op">*</span> <span class="va">prop_low</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="va">wave</span> <span class="op">+</span> <span class="va">treatment</span> <span class="op">|</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>  <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">cl_long3</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mrow><mn>3</mn><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>4</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>5</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>3</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>4</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>5</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><mi>α</mi></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>γ</mi><mn>0</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>γ</mi><mn>1</mn><msub><mi>β</mi><mn>1</mn></msub></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo>×</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><msub><mi>α</mi><mi>k</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>l</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>l</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>l</mi></msub><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><msub><mi>α</mi><mi>l</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub><msub><mi>α</mi><mi>l</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>γ</mi><mrow><mn>3</mn><mi>l</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i]} + \beta_{1j[i],k[i],l[i]}(\operatorname{wave}), \sigma^2 \right) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{group}_{\operatorname{low}}) + \gamma_{2}^{\alpha}(\operatorname{group}_{\operatorname{medium}}) + \gamma_{3l[i]}^{\alpha}(\operatorname{treatment}_{\operatorname{1}}) + \gamma_{4}^{\alpha}(\operatorname{group}_{\operatorname{low}} \times \operatorname{treatment}_{\operatorname{1}}) + \gamma_{5}^{\alpha}(\operatorname{group}_{\operatorname{medium}} \times \operatorname{treatment}_{\operatorname{1}}) \\
      &amp;\gamma^{\beta_{1}}_{0} + \gamma^{\beta_{1}}_{1}(\operatorname{group}_{\operatorname{low}}) + \gamma^{\beta_{1}}_{2}(\operatorname{group}_{\operatorname{medium}}) + \gamma^{\beta_{1}}_{3}(\operatorname{treatment}_{\operatorname{1}}) + \gamma^{\beta_{1}}_{4}(\operatorname{group}_{\operatorname{low}} \times \operatorname{treatment}_{\operatorname{1}}) + \gamma^{\beta_{1}}_{5}(\operatorname{group}_{\operatorname{medium}} \times \operatorname{treatment}_{\operatorname{1}})
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}}
  \end{array}
\right)
 \right)
    \text{, for sid j = 1,} \dots \text{,J} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{k} \\
      &amp;\beta_{1k}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\gamma_{0}^{\alpha} + \gamma_{1}^{\alpha}(\operatorname{prop\_low}) + \gamma_{2}^{\alpha}(\operatorname{prop\_low} \times \operatorname{treatment}_{\operatorname{1}}) \\
      &amp;\gamma^{\beta_{1}}_{0} + \gamma^{\beta_{1}}_{1}(\operatorname{prop\_low}) + \gamma^{\beta_{1}}_{1}(\operatorname{prop\_low} \times \operatorname{treatment}_{\operatorname{1}})
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{k}} &amp; \rho_{\alpha_{k}\beta_{1k}} \\ 
     \rho_{\beta_{1k}\alpha_{k}} &amp; \sigma^2_{\beta_{1k}}
  \end{array}
\right)
 \right)
    \text{, for school k = 1,} \dots \text{,K} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{l} \\
      &amp;\beta_{1l} \\
      &amp;\gamma_{3l}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{l}} \\
      &amp;\mu_{\beta_{1l}} \\
      &amp;\mu_{\gamma_{3l}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{ccc}
     \sigma^2_{\alpha_{l}} &amp; \rho_{\alpha_{l}\beta_{1l}} &amp; \rho_{\alpha_{l}\gamma_{3l}} \\ 
     \rho_{\beta_{1l}\alpha_{l}} &amp; \sigma^2_{\beta_{1l}} &amp; \rho_{\beta_{1l}\gamma_{3l}} \\ 
     \rho_{\gamma_{3l}\alpha_{l}} &amp; \rho_{\gamma_{3l}\beta_{1l}} &amp; \sigma^2_{\gamma_{3l}}
  \end{array}
\right)
 \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="alternative-variance-covariance-specifications">Alternative variance-covariance specifications<a class="anchor" aria-label="anchor" href="#alternative-variance-covariance-specifications"></a>
</h3>
<p>Finally, there is some support for alternative variance-covariance
specifications. For example, you may want to specify a model with only
the variance terms estimated, and not the covariances.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsb_varsonly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">minority</span> <span class="op">*</span> <span class="va">female</span> <span class="op">+</span> <span class="op">(</span><span class="va">minority</span> <span class="op">*</span> <span class="va">female</span> <span class="op">||</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">hsb_varsonly</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo>×</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>3</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1j[i]}(\operatorname{minority}) + \beta_{2j[i]}(\operatorname{female}) + \beta_{3j[i]}(\operatorname{female} \times \operatorname{minority}) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j} \\
      &amp;\beta_{2j} \\
      &amp;\beta_{3j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{1j}} \\
      &amp;\mu_{\beta_{2j}} \\
      &amp;\mu_{\beta_{3j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cccc}
     \sigma^2_{\alpha_{j}} &amp; 0 &amp; 0 &amp; 0 \\ 
     0 &amp; \sigma^2_{\beta_{1j}} &amp; 0 &amp; 0 \\ 
     0 &amp; 0 &amp; \sigma^2_{\beta_{2j}} &amp; 0 \\ 
     0 &amp; 0 &amp; 0 &amp; \sigma^2_{\beta_{3j}}
  \end{array}
\right)
 \right)
    \text{, for sch.id j = 1,} \dots \text{,J}
\end{aligned}
</annotation></semantics></math></p>
<p>Or maybe you want to group by the same thing multiple times. In this
exact model I don’t think this makes any sense, but there are cases
where it can. Note that, again, this model produces a warning.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsb_doublegroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">minority</span> <span class="op">*</span> <span class="va">female</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="va">minority</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">female</span> <span class="op">|</span> <span class="va">sch.id</span><span class="op">)</span>,</span>
<span>data <span class="op">=</span> <span class="va">hsb</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span><span class="co">#&gt; Model failed to converge with max|grad| = 0.00319858 (tol = 0.002, component 1)</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">hsb_doublegroup</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>math</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>μ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>female</mo><mo>×</mo><mo>minority</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>j</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>α</mi><mi>j</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub><msub><mi>α</mi><mi>k</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>2</mn><mi>k</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sch.id.1 k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{math}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i],k[i]} + \beta_{1j[i]}(\operatorname{minority}) + \beta_{2k[i]}(\operatorname{female}) + \beta_{3}(\operatorname{female} \times \operatorname{minority}) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{1j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; \rho_{\alpha_{j}\beta_{1j}} \\ 
     \rho_{\beta_{1j}\alpha_{j}} &amp; \sigma^2_{\beta_{1j}}
  \end{array}
\right)
 \right)
    \text{, for sch.id j = 1,} \dots \text{,J} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{k} \\
      &amp;\beta_{2k}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{k}} \\
      &amp;\mu_{\beta_{2k}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{k}} &amp; \rho_{\alpha_{k}\beta_{2k}} \\ 
     \rho_{\beta_{2k}\alpha_{k}} &amp; \sigma^2_{\beta_{2k}}
  \end{array}
\right)
 \right)
    \text{, for sch.id.1 k = 1,} \dots \text{,K}
\end{aligned}
</annotation></semantics></math></p>
<p>And finally, you can have a mix of different things and it should
generally still work.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_mixed_ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">wave</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="va">wave</span> <span class="op">||</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">wave</span> <span class="op">||</span> <span class="va">district</span><span class="op">)</span>,</span>
<span>  <span class="va">sim_longitudinal</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">long_mixed_ranef</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>score</mo><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>m</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>m</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>j</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>j</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>k</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>k</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ρ</mi><mrow><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><msub><mi>α</mi><mi>k</mi></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>α</mi><mi>l</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><msub><mi>α</mi><mi>l</mi></msub></msub><mo>,</mo><msubsup><mi>σ</mi><msub><mi>α</mi><mi>l</mi></msub><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school.1 l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>m</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>α</mi><mi>m</mi></msub></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>μ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>α</mi><mi>m</mi></msub><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>σ</mi><msub><mi>β</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district m = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,M</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{score}_{i}  &amp;\sim N \left(\alpha_{j[i],k[i],l[i],m[i]} + \beta_{1j[i],k[i],m[i]}(\operatorname{wave}), \sigma^2 \right) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{j}} \\
      &amp;\mu_{\beta_{1j}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{j}} &amp; 0 \\ 
     0 &amp; \sigma^2_{\beta_{1j}}
  \end{array}
\right)
 \right)
    \text{, for sid j = 1,} \dots \text{,J} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{k} \\
      &amp;\beta_{1k}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{k}} \\
      &amp;\mu_{\beta_{1k}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{k}} &amp; \rho_{\alpha_{k}\beta_{1k}} \\ 
     \rho_{\beta_{1k}\alpha_{k}} &amp; \sigma^2_{\beta_{1k}}
  \end{array}
\right)
 \right)
    \text{, for school k = 1,} \dots \text{,K} \\    \alpha_{l}  &amp;\sim N \left(\mu_{\alpha_{l}}, \sigma^2_{\alpha_{l}} \right)
    \text{, for school.1 l = 1,} \dots \text{,L} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{m} \\
      &amp;\beta_{1m}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\mu_{\alpha_{m}} \\
      &amp;\mu_{\beta_{1m}}
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     \sigma^2_{\alpha_{m}} &amp; 0 \\ 
     0 &amp; \sigma^2_{\beta_{1m}}
  \end{array}
\right)
 \right)
    \text{, for district m = 1,} \dots \text{,M}
\end{aligned}
</annotation></semantics></math></p>
<p>With that said, this is the part of the code that I would consider
the most “experimental” at this point, so please do reach out if you
have issues or run into use cases that are not supported.</p>
</div>
<div class="section level3">
<h3 id="using-estimated-coefficients">Using estimated coefficients<a class="anchor" aria-label="anchor" href="#using-estimated-coefficients"></a>
</h3>
<p>Because of the multilevel nature of the notation used by
<strong>{equatiomatic}</strong>, tracking the estimated coefficients can
at times be a little difficult. To help with this, we keep the Greek
notation with the estimated coefficients as subscripts. For example,
let’s extract the equation from our model with group-level
predictors.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_eq.html">extract_eq</a></span><span class="op">(</span><span class="va">group_preds_m1</span>, use_coef <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mover><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi></mrow><mo accent="true">̂</mo></mover><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mn>20.6</mn><msub><mi>α</mi><mrow><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></msub><mo>+</mo><msub><mn>0.17</mn><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>l</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>wave</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mn>5.23</mn><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>low</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mn>4.03</mn><msubsup><mi>γ</mi><mn>2</mn><mi>α</mi></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>group</mo><mo>medium</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mn>1.97</mn><msubsup><mi>γ</mi><mn>3</mn><mi>α</mi></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>treatment</mo><mo>1</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>9.29</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>0.2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>0.2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.29</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for sid j = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,J</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mn>12.81</mn><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>prop_low</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>2.84</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for school k = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,K</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>α</mi><mi>l</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>β</mi><mrow><mn>1</mn><mi>l</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mn>1.21</mn><msubsup><mi>γ</mi><mn>1</mn><mi>α</mi></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>dist_mean</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mtext mathvariant="normal">, for district l = 1,</mtext><mi>…</mi><mtext mathvariant="normal">,L</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{\widehat{score}}_{i}  &amp;\sim N \left(-20.6_{\alpha_{j[i],k[i],l[i]}} + 0.17_{\beta_{1j[i],k[i],l[i]}}(\operatorname{wave}), \sigma^2 \right) \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{j} \\
      &amp;\beta_{1j}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;-5.23_{\gamma_{1}^{\alpha}}(\operatorname{group}_{\operatorname{low}}) - 4.03_{\gamma_{2}^{\alpha}}(\operatorname{group}_{\operatorname{medium}}) - 1.97_{\gamma_{3}^{\alpha}}(\operatorname{treatment}_{\operatorname{1}}) \\
      &amp;0
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     9.29 &amp; -0.2 \\ 
     -0.2 &amp; 0.29
  \end{array}
\right)
 \right)
    \text{, for sid j = 1,} \dots \text{,J} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{k} \\
      &amp;\beta_{1k}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;12.81_{\gamma_{1}^{\alpha}}(\operatorname{prop\_low}) \\
      &amp;0
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     2.84 &amp; 1 \\ 
     1 &amp; 0
  \end{array}
\right)
 \right)
    \text{, for school k = 1,} \dots \text{,K} \\    
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;\alpha_{l} \\
      &amp;\beta_{1l}
    \end{aligned}
  \end{array}
\right)
  &amp;\sim N \left(
\left(
  \begin{array}{c} 
    \begin{aligned}
      &amp;1.21_{\gamma_{1}^{\alpha}}(\operatorname{dist\_mean}) \\
      &amp;0
    \end{aligned}
  \end{array}
\right)
, 
\left(
  \begin{array}{cc}
     0 &amp; -1 \\ 
     -1 &amp; 0
  \end{array}
\right)
 \right)
    \text{, for district l = 1,} \dots \text{,L}
\end{aligned}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="future-developments">Future developments<a class="anchor" aria-label="anchor" href="#future-developments"></a>
</h3>
<p>There are still a few things I’m planning to implement that I haven’t
quite gotten around to yet. These include</p>
<ul>
<li>Implementation of other features currently included in the
<code>lm</code> extraction, including <code>intercept</code>, and
<code>raw_tex</code>
</li>
<li>Inevitable bug fixes</li>
</ul>
<p>Additionally, the Greek notation as subscripts may not always be
desirable, particularly if the model is fairly simple. Future
developments will likely make this optional.</p>
<p>The range of models that you can fit with <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer</a></code> is
huge, but I hope this will handle a wide range of models. I also
recognize that some users may want a different notation for the models.
At this point, I’m not planning to implement other notations, but that
could change if there’s enough demand for it. I’m open to any/all
suggestions for how to improve the package, and would <em>love</em> pull
requests to help support the package, big or small.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniel Anderson, Andrew Heiss, Jay Sumners, Philippe Grosjean.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
